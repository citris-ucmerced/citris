<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-160189820-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-160189820-1');
    </script> -->
    <title>CITRIS and the Banatao Institute at UC Merced</title>
    <link rel="icon" href="images/favicon.png" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8
      ]><script src="assets/js/ie/html5shiv.js"></script
    ><![endif]-->
    <link rel="stylesheet" href="assets/css/main.css" />
    <script type="text/javascript" src="assets/js/ics.js"></script>
  </script>
  
  </head>

  <body class="homepage">
    <!-- 
        #########################################################################################
        # Are you a web developer for CITRIS? Looking to make modifications to this site?       #
        #                                                                                       #
        # Contact Brian Hungerman (brianhungerman@gmail.com) if you have any questions/concerns #
        #                                                                                       #
        # Please read README before making additions                                            #
        #########################################################################################
    -->

    <!-- IF SITE IS UNDER CONSTRUCTION, UNCOMMENT THE FOLLOWING DIV -->

    <!-- <div
        style="position:fixed;width:500px;height:40px;left:-100px;top:60px; transform: rotate(-45deg);z-index:10000;background-color:lightcoral;">
        <h2 style="color:white;">&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;Site under construction!</h2>
    </div> -->

    <div id="page-wrapper">
      <header id="header">
        <div class="logo container">
          <div>
            <h1 id="logo">CITRIS @ UC Merced</h1>
          </div>
        </div>
      </header>

      <!-- NAVIGATION: Controlled by HTML snippet in snippets/nav.html -->
      <nav id="nav"></nav>

      <!-- Banner -->
      <div id="banner-wrapper">
        <section id="banner">
          <!-- Brian's Todo note to self: generalize + dynamic-ize this -->
          <h2 id="banner-title" style="font-size:150%;">
           Welcome to CITRIS at University of California, MERCED
          </h2>

          <!-- 
                    THIS LINE CONTROLS THE "CURRENT EVENT BUTTON" BLURB
                    CHANGE THE HREF AND TEXT FOR THE EVENT BEING ADVERTISED
                -->
          <a
            id="banner-link"
            href="https://citris.ucmerced.edu/about"
            class="button"
            >Learn More</a
          >
        </section>
      </div>


      <div id="main-wrapper" > 
              
        <div id="main" class="container grid2" >
          <div class="row 200%">
            <div class="12u mainleft">
              <!-- RECENT NEWS: Controlled by HTML snippet in snippets/recent-news.html -->

              <!-- <aside>
                <h2 class="major facebook">
                <span>Facebook</span>
                <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v6.0"></script>
                <div id="facehook" class="fbwidget">
                  <div class="fb-page" data-href="https://www.facebook.com/citris-ucmerced" data-tabs="timeline,events" data-width="" data-height="" 
                  data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote 
                  cite="https://www.facebook.com/citris-ucmerced" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/citris-ucmerced">
                    CITRIS-UCMerced</a></blockquote></div>
                </div>
              </h2>

              </aside> -->
              <section>
                <a class="twitter-timeline" data-height="500" href="https://twitter.com/citris_ucmerced">Tweets by citris_ucmerced</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
              </section>

              <h2 class="major">
                <span>Upcoming Events</span>
              </h2>
              <section id="events"></section>
            </div>
          </div>
          
          <div class="row 200%">
            <div class="12u">
              <!-- RECENT NEWS: Controlled by HTML snippet in snippets/recent-news.html -->
              <h2 class="major">
                <span>Recent News</span>
              </h2>
              <section id="news"></section>
            </div>
          </div>
          <div class="row 200%">
            <div class="12u">
              <!-- WHO WE ARE: Controlled by HTML snippet in snippets/who-we-are.html -->
              <div id="who-we-are"></div>
            </div>
          </div>
          <div class="row 200%">
            <div class="12u">
              <h2 class="major">
                <span>Calendar</span>
              </h2>
              <div class="container-video">
          <iframe class="responsive-iframe" src="https://outlook.office365.com/owa/calendar/052188e02f6a4028bf55e1278cdb368c@ucmerced.edu/d37c6eb522ce413b91f5b97efdcc3fc714692294540219387417/calendar.html"scrolling="no" width="100%" height="700px">
          </iframe>
          </div>
        </div>
      </div>
          <div class="row 200%">
            <div class="12u">
              <h2 class="major">
                <span>CITRIS Initiatives</span>
              </h2>
              <!-- INITIATIVES: Controlled by HTML snippet in snippets/initiatives.html -->
              <div id="initiatives"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- FOOTER: Controlled by HTML snippet in snippets/footer.html-->
      <div id="footer"></div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="/assets/js/jquery.csv.min.js"></script>
    <script src="assets/js/skel.min.js"></script>
    <script src="assets/js/skel-viewport.min.js"></script>
    <script src="assets/js/util.js"></script>
    <!--[if lte IE 8
      ]><script src="assets/js/ie/respond.min.js"></script
    ><![endif]-->
    <script src="assets/js/main.js"></script>
    <script>

      //Calendar
      function toggleDropdown(ID) {
        document.getElementById(ID).classList.toggle("show");
      }

      // Close the dropdown if the user clicks outside of it
      window.onclick = function(event) {
        if (!event.target.matches(".dropbtn")) {
          var dropdowns = document.getElementsByClassName("dropdown-content");
          for (let i = 0; i < dropdowns.length; i++) {
            var openDropdown = dropdowns[i];
            if (openDropdown.classList.contains("show")) {
              openDropdown.classList.remove("show");
            }
          }
        }
      };

      function generateICSFile(title, description) {
        let calEntry = icsFormatter();

        let event = {
          title, 
          description,
          location: "University of California, Merced"
        }

        var begin = Date.now();
        var end = new Date(begin + 30 * 60000);

        calEntry.addEvent(
          event.title,
          event.description,
          event.location,
          begin,
          end
        );
        console.log(event);
        calEntry.download((event.title).toString());
      }
     

      $(function() {
        $("#nav").load("snippets/nav.html"); /*Navigation: Controlled by HTML snippet in snippets/nav.html*/

        $("#who-we-are").load(
          "snippets/who-we-are.html"
        ); /*WHO WE ARE: Controlled by HTML snippet in snippets/who-we-are.html*/
        $("#initiatives").load(
          "snippets/initiatives.html"
        ); /*INITIATIVES: Controlled by HTML snippet in snippets/initiatives.html*/
        $("#recent-news").load(
          "snippets/recent-news.html"
        ); /*RECENT NEWS: Controlled by HTML snippet in snippets/recent-news.html*/
        $("#footer").load(
          "snippets/footer.html"
        ); /*FOOTER: Controlled by HTML snippet in snippets/footer.html*/

        only_recent_events = true;
        finished_recent_events = false;
        $.get("events.csv").then(function(text, status, xhr) {
          var data = $.csv.toObjects(text);
          for (var i = 0; i < data.length; i++) {
            if (only_recent_events && finished_recent_events) break;
            switch (data[i].ID) {
              case "OLD":
                finished_recent_events = true;
                break;
              default:
                $("#events").append(
                  $.parseHTML(
                    '<section class="box features">' +
                      "<header>" +
                      "<h2>" +
                      data[i].TITLE +
                      "</h2>" +
                      "</header>" +
                      '<div style="display: block; overflow: auto">' +
                      '<img style= "margin: 0 1em 1em 0; float:left; width: 100%;" class="image featured" src="/images/events/' +
                      data[i].ID +
                      '.jpg" alt="" />' +
                      '<p style="margin:0;">' +
                      data[i].TEXT +
                      "</p>" +
                      "</div>" +
                      (data[i].LINK.toString() === "NO_BUTTON"
                        ? ""
                        : "<br>" +
                          '<center> <a class="button" href="' +
                          data[i].LINK +
                          '">Learn More</a>&nbsp;&nbsp;') +
                            
                            
                          '<div class="dropdown">' +
                          `<button onclick="toggleDropdown('${data[i].ID}')" class="dropbtn"> <i class="fa fa-calendar-o" aria-hidden="true"></i> Add to Calendar</button>` +
                          '<div id="' + data[i].ID + '" class="dropdown-content">' +
                          `<a href="http://www.google.com/calendar/render?action=TEMPLATE&text=${data[i].TITLE}&dates=${data[i].DATES}&details=${data[i].TEXT}&location=${data[i].LOCATION}">` + 
                          '<i class="fa fa-google" aria-hidden="true"></i> Google</a>' +
                          `<a onclick="generateICSFile('${data[i].TITLE}', '${data[i].TEXT}','${data[i].LOCATION}')"><i class="fa fa-apple" aria-hidden="true"></i> iCalendar</a>` +
                          `<a onclick="generateICSFile('${data[i].TITLE}', '${data[i].TEXT}')"> <i class="fa fa-windows" aria-hidden="true"></i> Outlook</a` +
                         
                          "</div>" +
                          "</div>" +
                          "</center>" +
                          // <!-- Button code -->
                          

                      "</section>"
                  )
                );
                break;
            }
          }
        });
        $.get("/news.csv").then(function(text, status, xhr) {
          var data = $.csv.toObjects(text);
          for (var i = 0; i < data.length; i++) {
            switch (data[i].ID) {
              default:
                $("#news").append(
                  $.parseHTML(
                    '<article class="box post">' +
                      "<header>" +
                      "<h3>" +
                      '<a href="' +
                      data[i].LINK +
                      '">' +
                      data[i].TITLE +
                      "</a>" +
                      "</h3>" +
                      '<ul class="meta">' +
                      '<li class="icon fa-clock-o">' +
                      data[i].DATE +
                      "</li>" +
                      "</ul>" +
                      "</header>" +
                      '<a href="' +
                      data[i].LINK +
                      '" class="image featured">' +
                      '<img src="images/news/' +
                      data[i].ID +
                      '.jpg" alt="" />' +
                      "</a>" +
                      "<p>" +
                      data[i].DESCRIPTION +
                      "</p>" +
                      "</article>"
                  )
                );
                break;
            }
          }
        });
      });
    </script>
    <script>
      var lines = "";
      var line_image = [];
      var line_text = [];
      var line_link = [];
      var slide_count = 0;
      $.get(
        "images/banners/items.txt",
        function(data) {
          lines = data.split("\n");
          for (var i = 0; i < lines.length; i++) {
            line_image[i] = lines[i].split(";")[0];
            line_text[i] = lines[i].split(";")[1];
            line_link[i] = lines[i].split(";")[2];
          }
          setInterval(function() {
            document.getElementById("banner-wrapper").style.backgroundImage =
              "url('assets/css/images/overlay.png'), url('assets/css/images/overlay.png'), url('images/banners/" +
              line_image[slide_count] +
              ".jpg')";
            document.getElementById("banner-title").innerText =
              line_text[slide_count];
            document.getElementById("banner-link").href =
              line_link[slide_count];
            slide_count++;
            if (slide_count >= lines.length) slide_count = 0;
          }, 5000);
        },
        "text"
      );
    </script>
  </body>
</html>
